




<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Live Class - WTEC1 LMS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="shortcut icon" href="../img/icon.ico" type="image/x-icon">
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4 sm:p-6">

  <!-- Header -->
  <header class="text-center mt-6 mb-6">
    <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">WTEC1 LMS - Live Class</h1>
    <p class="text-gray-600 text-sm sm:text-base mt-1">Join your class live, right here.</p>
  </header>

  <!-- Main Section -->
  <main class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-4 sm:p-6">
    <h2 class="text-lg sm:text-xl font-semibold text-center mb-4 text-blue-700">Live Stream</h2>

    <!-- Video Container -->
    <div id="videoContainer" class="relative w-full mb-3 sm:mb-0 rounded-md overflow-hidden" style="padding-bottom:56.25%; height:0;">
      <div id="loading" class="absolute inset-0 flex flex-col items-center justify-center bg-gray-50">
        <svg class="animate-spin h-8 w-8 text-blue-600 mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
        </svg>
        <p class="text-gray-600 text-sm">Loading live class...</p>
      </div>

      <iframe 
        id="liveStream"
        class="absolute top-0 left-0 w-full h-full rounded-md sm:rounded-lg hidden"
        src=""
        title="WTEC1 Live Class"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen>
      </iframe>
    </div>

    <p id="statusMessage" class="text-center text-gray-600 text-sm sm:text-base mt-4">
      Please wait a moment. The stream will appear once it goes live.
    </p>

     <div class="mt-3 sm:mt-4 p-3 sm:p-4 bg-blue-50 rounded-lg">
          <h3 class="font-semibold text-blue-800 mb-2 text-sm sm:text-base">Mobile Viewing Tips:</h3>
          <ul class="text-xs sm:text-sm text-blue-700 space-y-1">
            <li>â€¢ Rotate phone to landscape for better viewing</li>
            <li>â€¢ Tap fullscreen icon for maximum size</li>
            <li>â€¢ If no sound, tap the video once to unmute</li>
            <li>â€¢ Use "YouTube App" button for best mobile experience</li>
            <li>â€¢ Stream refreshes automatically every page reload</li>
          </ul>
        </div>

              
    <!-- Fallback Section - For students who miss live stream -->
    <div class="w-full max-w-6xl bg-white rounded-lg shadow-lg">
      <div class="p-4 sm:p-6">
        <h3 class="text-lg sm:text-xl font-semibold text-center mb-3 text-gray-800">
          You Need Free Videos?
        </h3>
        <p class="text-sm sm:text-base text-gray-600 text-center mb-4">
          When students want free Videos, they can access the recording or our channel here:
        </p>
        
        <div class="flex justify-center">
          <a href="https://www.youtube.com/channel/UCjeF__yoBqj6hk-8lMcL8DA/live" 
            
             rel="noopener noreferrer"
             class="inline-block bg-red-600 text-white px-6 py-3 rounded-md font-semibold hover:bg-red-700 transition text-center">
            ðŸŽ¥ Open in YouTube App
          </a>
        </div>

        <div class="mt-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200">
          <p class="text-xs sm:text-sm text-yellow-800 text-center">
            <strong>Note:</strong> Recordings may be available on your dashboard after the live stream ends.
          </p>
        </div>
      </div>
    
  </main>

  <!-- Footer -->
  <footer class="text-gray-500 text-xs sm:text-sm text-center mt-6">
    &copy; <span id="year"></span> WTEC1 LMS | All rights reserved.
  </footer>

  <script>
    // Automatically update year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Fetch live stream data
    (async function() {
      const loading = document.getElementById("loading");
      const iframe = document.getElementById("liveStream");
      const container = document.getElementById("videoContainer");
      const status = document.getElementById("statusMessage");

      try {
        const response = await fetch("/api/live");
        const data = await response.json();

        loading.remove(); // Remove spinner after response

        if (data.videoId) {
          iframe.src = `https://www.youtube.com/embed/${data.videoId}?autoplay=1`;
          iframe.classList.remove("hidden");
          status.textContent = "You're watching a live class now.";
        } else {
          container.innerHTML = `
            <div class="flex flex-col items-center justify-center bg-gray-50 h-60 text-center rounded-md">
              <p class="text-gray-700 font-medium mb-1">No live class is running right now.</p>
              <p class="text-gray-500 text-sm">Check back later or refresh this page closer to class time.</p>
            </div>`;
          status.textContent = "";
        }
      } catch (err) {
        console.error("Error loading live video:", err);
        container.innerHTML = `
          <div class="flex flex-col items-center justify-center bg-red-50 h-60 text-center rounded-md">
            <p class="text-red-700 font-medium mb-1">Could not load live class.</p>
            <p class="text-gray-500 text-sm">Please refresh the page or contact support.</p>
          </div>`;
        status.textContent = "";
      }
    })();
  </script>
</body>
</html>
